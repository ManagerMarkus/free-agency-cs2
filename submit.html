<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Submit Request</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <h1>Submit Request</h1>
  <form id="entryForm" style="max-width: 400px;">
    <label><input type="text" id="name" placeholder="Name" required /></label><br><br>
    <label>
      <select id="role" required>
        <option value="">Role</option>
        <option value="Player">Player</option>
        <option value="Coach">Coach</option>
        <option value="Organisation">Organisation</option>
      </select>
    </label><br><br>
    <label>
      <select id="region" required>
        <option value="">Region</option>
        <option value="EU">EU</option>
        <option value="NA">NA</option>
      </select>
    </label><br><br>
    <label>
      <select id="request" required>
        <option value="">Request</option>
        <option value="Looking for team">Looking for team</option>
        <option value="Looking for players">Looking for players</option>
        <option value="Looking for coach">Looking for coach</option>
      </select>
    </label><br><br>
    <label><input type="url" id="twitter" placeholder="Twitter Link" required /></label><br><br>
    <label><input type="url" id="moreInfo" placeholder="More Info (Twitter Post)" required /></label><br><br>
    <button type="submit" class="btn submit">Absenden</button>
  </form>

  <div id="status"></div>

  <script>
    const supabaseUrl = "{supabase_url}";
    const supabaseKey = "{supabase_key}";

    document.getElementById("entryForm").addEventListener("submit", async function (e) {
      e.preventDefault();
      const obj = {
        name: name.value,
        role: role.value,
        region: region.value,
        request: request.value,
        twitter: twitter.value,
        moreInfo: moreInfo.value,
        active: "yes"
      };

      const res = await fetch(supabaseUrl + "/rest/v1/entries", {
        method: "POST",
        headers: {
          apikey: supabaseKey,
          Authorization: "Bearer " + supabaseKey,
          "Content-Type": "application/json"
        },
        body: JSON.stringify(obj)
      });

      if (res.status === 201) {
        document.getElementById("status").innerText = "✅ Erfolgreich übermittelt!";
        document.getElementById("entryForm").reset();
      } else {
        document.getElementById("status").innerText = "❌ Fehler beim Absenden.";
      }
    });
  </script>
</body>
</html>
