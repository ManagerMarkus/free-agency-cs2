
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Admin Panel</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="admin-wrapper">
    <h1>Admin Panel</h1>
    <form id="entryForm">
      <input type="text" id="name" placeholder="Name" required />
      <input type="text" id="role" placeholder="Role" required />
      <input type="text" id="region" placeholder="Region" required />
      <input type="text" id="request" placeholder="Request" required />
      <input type="url" id="twitter" placeholder="Twitter Link" required />
      <input type="url" id="moreInfo" placeholder="More Info (Twitter Post)" required />
      <select id="active" required>
        <option value="">Active?</option>
        <option value="yes">yes</option>
        <option value="no">no</option>
      </select>
      <button type="submit">Submit to Sheet</button>
    </form>
    <p id="successMsg" style="display:none; color: green;">✅ Entry successfully submitted!</p>
    <p id="errorMsg" style="display:none; color: red;">❌ Failed to submit entry.</p>
  </div>

  <script>
    const form = document.getElementById('entryForm');
    const successMsg = document.getElementById('successMsg');
    const errorMsg = document.getElementById('errorMsg');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      const data = {
        name: document.getElementById('name').value,
        role: document.getElementById('role').value,
        region: document.getElementById('region').value,
        request: document.getElementById('request').value,
        twitter: document.getElementById('twitter').value,
        moreInfo: document.getElementById('moreInfo').value,
        active: document.getElementById('active').value
      };

      try {
        const response = await fetch('https://script.google.com/macros/s/AKfycbyFrAncdo_Hu39UnKX8zIOOf1GJdibhqgA2tAy6U8A9c0eptSgM3SfD6zhyhSJPqzjnvg/exec', {
          method: 'POST',
          body: JSON.stringify(data),
          headers: {
            'Content-Type': 'application/json'
          }
        });

        if (response.ok) {
          successMsg.style.display = 'block';
          errorMsg.style.display = 'none';
          form.reset();
        } else {
          throw new Error();
        }
      } catch {
        successMsg.style.display = 'none';
        errorMsg.style.display = 'block';
      }
    });
  </script>
</body>
</html>
